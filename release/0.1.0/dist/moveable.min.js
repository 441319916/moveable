/*
Copyright (c) 2019 Daybrush
name: moveable
license: MIT
author: Daybrush
repository: git+https://github.com/daybrush/moveable.git
version: 0.1.0
*/
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).Moveable=e()}(this,function(){"use strict";var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function i(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var a=function(){return(a=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function s(t){return void 0===t}var t=function(){var t=function(){function t(){this._eventHandler={},this.options={}}var e=t.prototype;return e.trigger=function(t,e){void 0===e&&(e={});var n=this._eventHandler[t]||[];if(!(0<n.length))return!0;n=n.concat(),e.eventType=t;var r=!1,o=[e],i=0;e.stop=function(){r=!0},e.currentTarget=this;for(var a=arguments.length,s=new Array(2<a?a-2:0),l=2;l<a;l++)s[l-2]=arguments[l];for(1<=s.length&&(o=o.concat(s)),i=0;n[i];i++)n[i].apply(this,o);return!r},e.once=function(o,i){if("object"==typeof o&&s(i)){var t,e=o;for(t in e)this.once(t,e[t]);return this}if("string"==typeof o&&"function"==typeof i){var a=this;this.on(o,function t(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];i.apply(a,n),a.off(o,t)})}return this},e.hasOn=function(t){return!!this._eventHandler[t]},e.on=function(t,e){if("object"==typeof t&&s(e)){var n,r=t;for(n in r)this.on(n,r[n]);return this}if("string"==typeof t&&"function"==typeof e){var o=this._eventHandler[t];s(o)&&(this._eventHandler[t]=[],o=this._eventHandler[t]),o.push(e)}return this},e.off=function(t,e){if(s(t))return this._eventHandler={},this;if(s(e)){if("string"==typeof t)return this._eventHandler[t]=void 0,this;var n,r=t;for(n in r)this.off(n,r[n]);return this}var o,i,a=this._eventHandler[t];if(a)for(o=0;void 0!==(i=a[o]);o++)if(i===e){a=a.splice(o,1);break}return this},t}();return t.VERSION="2.1.2",t}();function f(e,n){return function(t){t&&(e[n]=t)}}var l=function(){},p={},c=[],u=[];function d(t,e){var n,r,o,i,a=u;for(i=arguments.length;2<i--;)c.push(arguments[i]);for(e&&null!=e.children&&(c.length||c.push(e.children),delete e.children);c.length;)if((r=c.pop())&&void 0!==r.pop)for(i=r.length;i--;)c.push(r[i]);else"boolean"==typeof r&&(r=null),(o="function"!=typeof t)&&(null==r?r="":"number"==typeof r?r=String(r):"string"!=typeof r&&(o=!1)),o&&n?a[a.length-1]+=r:a===u?a=[r]:a.push(r),n=o;var s=new l;return s.nodeName=t,s.children=a,s.attributes=null==e?void 0:e,s.key=null==e?void 0:e.key,void 0!==p.vnode&&p.vnode(s),s}function C(t,e){for(var n in e)t[n]=e[n];return t}function h(t,e){null!=t&&("function"==typeof t?t(e):t.current=e)}var e="function"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout,v=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,n=[];function g(t){!t._dirty&&(t._dirty=!0)&&1==n.push(t)&&e(o)}function o(){for(var t;t=n.pop();)t._dirty&&T(t)}function P(t,e){return t.normalizedNodeName===e||t.nodeName.toLowerCase()===e.toLowerCase()}function D(t){var e=C({},t.attributes);e.children=t.children;var n=t.nodeName.defaultProps;if(void 0!==n)for(var r in n)void 0===e[r]&&(e[r]=n[r]);return e}function O(t){var e=t.parentNode;e&&e.removeChild(t)}function m(t,e,n,r,o){if("className"===e&&(e="class"),"key"===e);else if("ref"===e)h(n,null),h(r,t);else if("class"!==e||o)if("style"===e){if(r&&"string"!=typeof r&&"string"!=typeof n||(t.style.cssText=r||""),r&&"object"==typeof r){if("string"!=typeof n)for(var i in n)i in r||(t.style[i]="");for(var i in r)t.style[i]="number"==typeof r[i]&&!1===v.test(i)?r[i]+"px":r[i]}}else if("dangerouslySetInnerHTML"===e)r&&(t.innerHTML=r.__html||"");else if("o"==e[0]&&"n"==e[1]){var a=e!==(e=e.replace(/Capture$/,""));e=e.toLowerCase().substring(2),r?n||t.addEventListener(e,y,a):t.removeEventListener(e,y,a),(t._listeners||(t._listeners={}))[e]=r}else if("list"!==e&&"type"!==e&&!o&&e in t){try{t[e]=null==r?"":r}catch(t){}null!=r&&!1!==r||"spellcheck"==e||t.removeAttribute(e)}else{var s=o&&e!==(e=e.replace(/^xlink:?/,""));null==r||!1===r?s?t.removeAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase()):t.removeAttribute(e):"function"!=typeof r&&(s?t.setAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase(),r):t.setAttribute(e,r))}else t.className=r||""}function y(t){return this._listeners[t.type](p.event&&p.event(t)||t)}var E=[],R=0,b=!1,_=!1;function M(){for(var t;t=E.shift();)t.componentDidMount&&t.componentDidMount()}function k(t,e,n,r,o,i){R++||(b=null!=o&&void 0!==o.ownerSVGElement,_=null!=t&&!("__preactattr_"in t));var a=z(t,e,n,r,i);return o&&a.parentNode!==o&&o.appendChild(a),--R||(_=!1,i||M()),a}function z(t,e,n,r,o){var i=t,a=b;if(null!=e&&"boolean"!=typeof e||(e=""),"string"==typeof e||"number"==typeof e)return t&&void 0!==t.splitText&&t.parentNode&&(!t._component||o)?t.nodeValue!=e&&(t.nodeValue=e):(i=document.createTextNode(e),t&&(t.parentNode&&t.parentNode.replaceChild(i,t),j(t,!0))),i.__preactattr_=!0,i;var s=e.nodeName;if("function"==typeof s)return function(t,e,n,r){var o=t&&t._component,i=o,a=t,s=o&&t._componentConstructor===e.nodeName,l=s,p=D(e);for(;o&&!l&&(o=o._parentComponent);)l=o.constructor===e.nodeName;o&&l&&(!r||o._component)?(W(o,p,3,n,r),t=o.base):(i&&!s&&(B(i),t=a=null),o=L(e.nodeName,p,n),t&&!o.nextBase&&(o.nextBase=t,a=null),W(o,p,1,n,r),t=o.base,a&&t!==a&&(a._component=null,j(a,!1)));return t}(t,e,n,r);if(b="svg"===s||"foreignObject"!==s&&b,s=String(s),(!t||!P(t,s))&&(i=function(t,e){var n=e?document.createElementNS("http://www.w3.org/2000/svg",t):document.createElement(t);return n.normalizedNodeName=t,n}(s,b),t)){for(;t.firstChild;)i.appendChild(t.firstChild);t.parentNode&&t.parentNode.replaceChild(i,t),j(t,!0)}var l=i.firstChild,p=i.__preactattr_,c=e.children;if(null==p){p=i.__preactattr_={};for(var u=i.attributes,f=u.length;f--;)p[u[f].name]=u[f].value}return!_&&c&&1===c.length&&"string"==typeof c[0]&&null!=l&&void 0!==l.splitText&&null==l.nextSibling?l.nodeValue!=c[0]&&(l.nodeValue=c[0]):(c&&c.length||null!=l)&&function(t,e,n,r,o){var i,a,s,l,p,c=t.childNodes,u=[],f={},d=0,h=0,v=c.length,g=0,m=e?e.length:0;if(0!==v)for(var y=0;y<v;y++){var b=c[y],_=b.__preactattr_;null!=(x=m&&_?b._component?b._component.__key:_.key:null)?(d++,f[x]=b):(_||(void 0!==b.splitText?!o||b.nodeValue.trim():o))&&(u[g++]=b)}if(0!==m)for(y=0;y<m;y++){var x;if(l=e[y],(p=null)!=(x=l.key))d&&void 0!==f[x]&&(p=f[x],f[x]=void 0,d--);else if(h<g)for(i=h;i<g;i++)if(void 0!==u[i]&&(w=a=u[i],N=o,"string"==typeof(S=l)||"number"==typeof S?void 0!==w.splitText:"string"==typeof S.nodeName?!w._componentConstructor&&P(w,S.nodeName):N||w._componentConstructor===S.nodeName)){p=a,u[i]=void 0,i===g-1&&g--,i===h&&h++;break}p=z(p,l,n,r),s=c[y],p&&p!==t&&p!==s&&(null==s?t.appendChild(p):p===s.nextSibling?O(s):t.insertBefore(p,s))}var w,S,N;if(d)for(var y in f)void 0!==f[y]&&j(f[y],!1);for(;h<=g;)void 0!==(p=u[g--])&&j(p,!1)}(i,c,n,r,_||null!=p.dangerouslySetInnerHTML),function(t,e,n){var r;for(r in n)e&&null!=e[r]||null==n[r]||m(t,r,n[r],n[r]=void 0,b);for(r in e)"children"===r||"innerHTML"===r||r in n&&e[r]===("value"===r||"checked"===r?t[r]:n[r])||m(t,r,n[r],n[r]=e[r],b)}(i,e.attributes,p),b=a,i}function j(t,e){var n=t._component;n?B(n):(null!=t.__preactattr_&&h(t.__preactattr_.ref,null),!1!==e&&null!=t.__preactattr_||O(t),x(t))}function x(t){for(t=t.lastChild;t;){var e=t.previousSibling;j(t,!0),t=e}}var w=[];function L(t,e,n){var r,o=w.length;for(t.prototype&&t.prototype.render?(r=new t(e,n),N.call(r,e,n)):((r=new N(e,n)).constructor=t,r.render=S);o--;)if(w[o].constructor===t)return r.nextBase=w[o].nextBase,w.splice(o,1),r;return r}function S(t,e,n){return this.constructor(t,n)}function W(t,e,n,r,o){t._disable||(t._disable=!0,t.__ref=e.ref,t.__key=e.key,delete e.ref,delete e.key,void 0===t.constructor.getDerivedStateFromProps&&(!t.base||o?t.componentWillMount&&t.componentWillMount():t.componentWillReceiveProps&&t.componentWillReceiveProps(e,r)),r&&r!==t.context&&(t.prevContext||(t.prevContext=t.context),t.context=r),t.prevProps||(t.prevProps=t.props),t.props=e,t._disable=!1,0!==n&&(1!==n&&!1===p.syncComponentUpdates&&t.base?g(t):T(t,1,o)),h(t.__ref,t))}function T(t,e,n,r){if(!t._disable){var o,i,a,s=t.props,l=t.state,p=t.context,c=t.prevProps||s,u=t.prevState||l,f=t.prevContext||p,d=t.base,h=t.nextBase,v=d||h,g=t._component,m=!1,y=f;if(t.constructor.getDerivedStateFromProps&&(l=C(C({},l),t.constructor.getDerivedStateFromProps(s,l)),t.state=l),d&&(t.props=c,t.state=u,t.context=f,2!==e&&t.shouldComponentUpdate&&!1===t.shouldComponentUpdate(s,l,p)?m=!0:t.componentWillUpdate&&t.componentWillUpdate(s,l,p),t.props=s,t.state=l,t.context=p),t.prevProps=t.prevState=t.prevContext=t.nextBase=null,t._dirty=!1,!m){o=t.render(s,l,p),t.getChildContext&&(p=C(C({},p),t.getChildContext())),d&&t.getSnapshotBeforeUpdate&&(y=t.getSnapshotBeforeUpdate(c,u));var b,_,x=o&&o.nodeName;if("function"==typeof x){var w=D(o);(i=g)&&i.constructor===x&&w.key==i.__key?W(i,w,1,p,!1):(b=i,t._component=i=L(x,w,p),i.nextBase=i.nextBase||h,i._parentComponent=t,W(i,w,0,p,!1),T(i,1,n,!0)),_=i.base}else a=v,(b=g)&&(a=t._component=null),!v&&1!==e||(a&&(a._component=null),_=k(a,o,p,n||!d,v&&v.parentNode,!0));if(v&&_!==v&&i!==g){var S=v.parentNode;S&&_!==S&&(S.replaceChild(_,v),b||(v._component=null,j(v,!1)))}if(b&&B(b),(t.base=_)&&!r){for(var N=t,P=t;P=P._parentComponent;)(N=P).base=_;_._component=N,_._componentConstructor=N.constructor}}for(!d||n?E.push(t):m||t.componentDidUpdate&&t.componentDidUpdate(c,u,y);t._renderCallbacks.length;)t._renderCallbacks.pop().call(t);R||r||M()}}function B(t){var e=t.base;t._disable=!0,t.componentWillUnmount&&t.componentWillUnmount(),t.base=null;var n=t._component;n?B(n):e&&(null!=e.__preactattr_&&h(e.__preactattr_.ref,null),O(t.nextBase=e),w.push(t),x(e)),h(t.__ref,null)}function N(t,e){this._dirty=!0,this.context=e,this.props=t,this.state=this.state||{},this._renderCallbacks=[]}C(N.prototype,{setState:function(t,e){this.prevState||(this.prevState=this.state),this.state=C(C({},this.state),"function"==typeof t?t(this.state,this.props):t),e&&this._renderCallbacks.push(e),g(this)},forceUpdate:function(t){t&&this._renderCallbacks.push(t),T(this,2)},render:function(){}});U=function(t,e){return(U=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var U,A="a abbr address area article aside audio b base bdi bdo big blockquote body br button canvas caption cite code col colgroup data datalist dd del details dfn dialog div dl dt em embed fieldset figcaption figure footer form h1 h2 h3 h4 h5 h6 head header hgroup hr html i iframe img input ins kbd keygen label legend li link main map mark menu menuitem meta meter nav noscript object ol optgroup option output p param picture pre progress q rp rt ruby s samp script section select small source span strong style sub summary sup table tbody td textarea tfoot th thead time title tr track u ul var video wbr circle clipPath defs ellipse g image line linearGradient mask path pattern polygon polyline radialGradient rect stop svg text tspan".split(" "),H="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,X="undefined"!=typeof Symbol&&Symbol.for?Symbol.for("__preactCompatWrapper"):"__preactCompatWrapper",Y={constructor:1,render:1,shouldComponentUpdate:1,componentWillReceiveProps:1,componentWillUpdate:1,componentDidUpdate:1,componentWillMount:1,componentDidMount:1,componentWillUnmount:1,componentDidUnmount:1},F=/^(?:accent|alignment|arabic|baseline|cap|clip|color|fill|flood|font|glyph|horiz|marker|overline|paint|stop|strikethrough|stroke|text|underline|unicode|units|v|vector|vert|word|writing|x)[A-Z]/,I={},V=!1;try{V="production"!==process.env.NODE_ENV}catch(t){}var $=d("a",null).constructor;$.prototype.$$typeof=H,$.prototype.preactCompatUpgraded=!1,$.prototype.preactCompatNormalized=!1,Object.defineProperty($.prototype,"type",{get:function(){return this.nodeName},set:function(t){this.nodeName=t},configurable:!0}),Object.defineProperty($.prototype,"props",{get:function(){return this.attributes},set:function(t){this.attributes=t},configurable:!0});var q=p.event;p.event=function(t){return q&&(t=q(t)),t.persist=Object,t.nativeEvent=t};var G=p.vnode;p.vnode=function(t){if(!t.preactCompatUpgraded){t.preactCompatUpgraded=!0;var e=t.nodeName,n=t.attributes=null==t.attributes?{}:it({},t.attributes);"function"==typeof e?(!0===e[X]||e.prototype&&"isReactComponent"in e.prototype)&&(t.children&&""===String(t.children)&&(t.children=void 0),t.children&&(n.children=t.children),t.preactCompatNormalized||rt(t),function(t){var e=t.nodeName,n=t.attributes;t.attributes={},e.defaultProps&&it(t.attributes,e.defaultProps);n&&it(t.attributes,n)}(t)):(t.children&&""===String(t.children)&&(t.children=void 0),t.children&&(n.children=t.children),n.defaultValue&&(n.value||0===n.value||(n.value=n.defaultValue),delete n.defaultValue),function(t,e){var n,r,o;if(e){for(o in e)if(n=F.test(o))break;if(n)for(o in r=t.attributes={},e)e.hasOwnProperty(o)&&(r[F.test(o)?o.replace(/([A-Z0-9])/,"-$1").toLowerCase():o]=e[o])}}(t,n))}G&&G(t)};var Z,J=[];for(var K,Q={},tt=A.length;tt--;)Q[A[tt]]=(K=A[tt],nt.bind(null,K));function et(t){return function(t){function e(t,e){!function(t){for(var e in t){var n=t[e];"function"!=typeof n||n.__bound||Y.hasOwnProperty(e)||((t[e]=n.bind(t)).__bound=!0)}}(this),ht.call(this,t,e,I),ct.call(this,t,e)}(t=it({constructor:e},t)).mixins&&function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=pt(e[n].concat(t[n]||J),"getDefaultProps"===n||"getInitialState"===n||"getChildContext"===n))}(t,function(t){for(var e={},n=0;n<t.length;n++){var r=t[n];for(var o in r)r.hasOwnProperty(o)&&"function"==typeof r[o]&&(e[o]||(e[o]=[])).push(r[o])}return e}(t.mixins));t.statics&&it(e,t.statics);t.propTypes&&(e.propTypes=t.propTypes);t.defaultProps&&(e.defaultProps=t.defaultProps);t.getDefaultProps&&(e.defaultProps=t.getDefaultProps.call(e));return st.prototype=ht.prototype,e.prototype=it(new st,t),e.displayName=t.displayName||"Component",e}({displayName:t.displayName||t.name,render:function(){return t(this.props,this.context)}})}function nt(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return function t(e,n){for(var r=n||0;r<e.length;r++){var o=e[r];Array.isArray(o)?t(o):!o||"object"!=typeof o||(i=o)&&(i instanceof $||i.$$typeof===H)||!(o.props&&o.type||o.attributes&&o.nodeName||o.children)||(e[r]=nt(o.type||o.nodeName,o.props||o.attributes,o.children))}var i}(t,2),rt(d.apply(void 0,t))}function rt(t){t.preactCompatNormalized=!0,function(t){var e=t.attributes||(t.attributes={});ot.enumerable="className"in e,e.className&&(e.class=e.className);Object.defineProperty(e,"className",ot)}(t),function(t){return"function"==typeof t&&!(t.prototype&&t.prototype.render)}(t.nodeName)&&(t.nodeName=function(t){var e=t[X];return e?!0===e?t:e:(e=et(t),Object.defineProperty(e,X,{configurable:!0,value:!0}),e.displayName=t.displayName,e.propTypes=t.propTypes,e.defaultProps=t.defaultProps,Object.defineProperty(t,X,{configurable:!0,value:e}),e)}(t.nodeName));var e=t.attributes.ref,n=e&&typeof e;return!Z||"string"!==n&&"number"!==n||(t.attributes.ref=function(e,n){return n._refProxies[e]||(n._refProxies[e]=function(t){n&&n.refs&&null===(n.refs[e]=t)&&(delete n._refProxies[e],n=null)})}(e,Z)),function(t){var e=t.nodeName,n=t.attributes;if(!n||"string"!=typeof e)return;var r={};for(var o in n)r[o.toLowerCase()]=o;r.ondoubleclick&&(n.ondblclick=n[r.ondoubleclick],delete n[r.ondoubleclick]);if(r.onchange&&("textarea"===e||"input"===e.toLowerCase()&&!/^fil|che|rad/i.test(n.type))){var i=r.oninput||"oninput";n[i]||(n[i]=pt([n[i],n[r.onchange]]),delete n[r.onchange])}}(t),t}var ot={configurable:!0,get:function(){return this.class},set:function(t){this.class=t}};function it(t){for(var e=arguments,n=1,r=void 0;n<arguments.length;n++)if(r=e[n])for(var o in r)r.hasOwnProperty(o)&&(t[o]=r[o]);return t}function at(t,e){for(var n in t)if(!(n in e))return!0;for(var r in e)if(t[r]!==e[r])return!0;return!1}function st(){}function lt(t,e,n){if("string"==typeof e&&(e=t.constructor.prototype[e]),"function"==typeof e)return e.apply(t,n)}function pt(i,a){return function(){for(var t,e=arguments,n=0;n<i.length;n++){var r=lt(this,i[n],e);if(a&&null!=r)for(var o in t=t||{},r)r.hasOwnProperty(o)&&(t[o]=r[o]);else void 0!==r&&(t=r)}return t}}function ct(t,e){ut.call(this,t,e),this.componentWillReceiveProps=pt([ut,this.componentWillReceiveProps||"componentWillReceiveProps"]),this.render=pt([ut,ft,this.render||"render",dt])}function ut(t,e){if(t){var n=t.children;if(n&&Array.isArray(n)&&1===n.length&&("string"==typeof n[0]||"function"==typeof n[0]||n[0]instanceof $)&&(t.children=n[0],t.children&&"object"==typeof t.children&&(t.children.length=1,t.children[0]=t.children)),V){var r="function"==typeof this?this:this.constructor;this.propTypes||r.propTypes,this.displayName||r.name}}}function ft(t){Z=this}function dt(){Z===this&&(Z=null)}function ht(t,e,n){N.call(this,t,e),this.state=this.getInitialState?this.getInitialState():{},this.refs={},this._refProxies={},n!==I&&ct.call(this,t,e)}function vt(t,e){ht.call(this,t,e)}it(ht.prototype=new N,{constructor:ht,isReactComponent:{},replaceState:function(t,e){for(var n in this.setState(t,e),this.state)n in t||delete this.state[n]},getDOMNode:function(){return this.base},isMounted:function(){return!!this.base}}),st.prototype=ht.prototype,(vt.prototype=new st).isPureReactComponent=!0,vt.prototype.shouldComponentUpdate=function(t,e){return at(this.props,t)||at(this.state,e)};var gt="undefined";function mt(t){return typeof t===gt}function yt(t,e){return t.classList?t.classList.contains(e):!!t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}var bt=function(t,e){return(bt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var _t=function(){return(_t=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};var xt=function(t){for(var e=5381,n=t.length;n;)e=33*e^t.charCodeAt(--n);return e>>>0};function wt(t,e){var a=!1,s=0,l=0,p=0,c=0,u={},f=!1,n=e.container,r=void 0===n?t:n,o=e.dragstart,d=e.drag,i=e.dragend,h=e.events,v=void 0===h?["touch","mouse"]:h,g=-1<v.indexOf("touch"),m=-1<v.indexOf("mouse");function y(t){return t.touches&&t.touches.length?t.touches[0]:t}function b(t){f=!(a=!0);var e=y(t),n=e.clientX,r=e.clientY;p=s=n,c=l=r,!(u={})===(o&&o({datas:u,inputEvent:t,clientX:n,clientY:r}))&&(a=!1),a&&t.preventDefault()}function _(t){if(a){var e=y(t),n=e.clientX,r=e.clientY,o=n-p,i=r-c;(o||i)&&(f=!0,d&&d({datas:u,clientX:n,clientY:r,deltaX:o,deltaY:i,distX:n-s,distY:r-l,inputEvent:t}),p=n,c=r)}}function x(t){a&&(a=!1,i&&i({datas:u,isDrag:f,inputEvent:t,clientX:p,clientY:c,distX:p-s,distY:c-l}))}return m&&(t.addEventListener("mousedown",b),r.addEventListener("mousemove",_),r.addEventListener("mouseup",x)),g&&(t.addEventListener("touchstart",b),r.addEventListener("touchmove",_),r.addEventListener("touchend",x)),{unset:function(){m&&(t.removeEventListener("mousedown",b),r.removeEventListener("mousemove",_),r.removeEventListener("mouseup",x)),g&&(t.removeEventListener("touchstart",b),r.removeEventListener("touchmove",_),r.removeEventListener("touchend",x))}}}var St=function(t,e){return(St=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var Nt="moveable-",Pt="\n{\n    position: fixed;\n    width: 0;\n    height: 0;\n    left: 0;\n    top: 0;\n    z-index: 3000;\n}\n.control {\n    position: absolute;\n    width: 14px;\n    height: 14px;\n    border-radius: 50%;\n    border: 2px solid #fff;\n    box-sizing: border-box;\n    background: #4af;\n    margin-top: -7px;\n    margin-left: -7px;\n}\n.line {\n    position: absolute;\n    width: 1px;\n    height: 1px;\n    background: #4af;\n    transform-origin: 0px 0.5px;\n}\n.line.rotation {\n    width: 40px;\n}\n.line.rotation .control {\n    left: 100%;\n    border-color: #4af;\n    background:#fff;\n    cursor: alias;\n}\n.control.e, .control.w {\n    cursor: ew-resize;\n}\n.control.s, .control.n {\n    cursor: ns-resize;\n}\n.control.nw, .control.se, :host.reverse .control.ne, :host.reverse .control.sw {\n    cursor: nwse-resize;\n}\n.control.ne, .control.sw, :host.reverse .control.nw, :host.reverse .control.se {\n    cursor: nesw-resize;\n}\n".replace(/\.([^{,\s\d.]+)/g,"."+Nt+"$1");function Ct(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.map(function(t){return t.split(" ").map(function(t){return""+e+t}).join(" ")}).join(" ")}.apply(void 0,[Nt].concat(t))}function Dt(t,e){return[t[0]*e[0]+t[2]*e[1]+t[4]*e[2],t[1]*e[0]+t[3]*e[1]+t[5]*e[2]]}function Ot(t,e){var n=t[0],r=t[1],o=t[2],i=t[3],a=t[4],s=t[5],l=e[0],p=e[1],c=e[2],u=e[3],f=e[4],d=e[5];return t[0]=n*l+o*p,t[1]=r*l+i*p,t[2]=n*c+o*u,t[3]=r*c+i*u,t[4]=n*f+o*d+1*a,t[5]=r*f+i*d+1*s,t}function Et(t){var e=t[0],n=t[1],r=t[2],o=t[3],i=t[4],a=t[5],s=e*o*1+r*a*0+i*n*0-i*o*0-r*n*1-e*a*0,l=1*o-0*a,p=0*i-1*r,c=r*a-i*o,u=0*a-1*n,f=1*e-0*i,d=i*n-e*a;return t[0]=l/s,t[1]=u/s,t[2]=p/s,t[3]=f/s,t[4]=c/s,t[5]=d/s,t}function Rt(t,e,n,r){var o=Dt(t,[0,0,1]),i=o[0],a=o[1],s=Dt(t,[n,0,1]),l=s[0],p=s[1],c=Dt(t,[0,r,1]),u=c[0],f=c[1],d=Dt(t,[n,r,1]),h=d[0],v=d[1],g=Dt(t,[e[0],e[1],1]),m=g[0],y=g[1],b=Math.min(i,l,u,h),_=Math.min(a,p,f,v);return[[m=m-b||0,y=y-_||0],[i=i-b||0,a=a-_||0],[l=l-b||0,p=p-_||0],[u=u-b||0,f=f-_||0],[h=h-b||0,v=v-_||0]]}function Mt(t,e){var n=e[0]-t[0],r=e[1]-t[1],o=Math.atan2(r,n);return 0<o?o:o+2*Math.PI}function kt(t,e){var n=e[0]-t[0],r=e[1]-t[1],o=Math.sqrt(n*n+r*r),i=Mt(t,e);return"translate("+t[0]+"px, "+t[1]+"px) rotate("+i+"rad) scale("+o+", 1.2)"}function zt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t.length;return{transform:"translate("+t.reduce(function(t,e){return t+e[0]},0)/n+"px, "+t.reduce(function(t,e){return t+e[1]},0)/n+"px)"}}function jt(t,e,n,r){void 0===e&&(e=window.getComputedStyle(t)),void 0===r&&(r=n||"border-box"===e.boxSizing);var o=t.offsetWidth,i=t.offsetHeight,a=!mt(o);return(n||r)&&a?[o,i]:(o=t.clientWidth,i=t.clientHeight,n||r?[o+(parseFloat(e.borderLeftWidth)||0)+(parseFloat(e.borderRightWidth)||0),i+(parseFloat(e.borderTopWidth)||0)+(parseFloat(e.borderBottomWidth)||0)]:[o-(parseFloat(e.paddingLeft)||0)-(parseFloat(e.paddingRight)||0),i-(parseFloat(e.paddingTop)||0)-(parseFloat(e.paddingBottom)||0)])}function Lt(t){var e,n,r,o=0,i=0,a=[0,0],s=[0,0],l=[0,0],p=[0,0],c=[0,0],u=[1,0,0,1,0,0],f=[1,0,0,1,0,0],d=0,h=0,v=[0,0];if(t){var g=t.getBoundingClientRect(),m=window.getComputedStyle(t);o=g.left,i=g.top,d=t.offsetWidth,h=t.offsetHeight,mt(d)&&(d=(e=jt(t,m,!0))[0],h=e[1]),u=(n=function(t){for(var e,n=t,r=[];n;){var o=window.getComputedStyle(n).transform;if("none"!==o){var i=(void 0,!(e=/([^(]*)\(([\s\S]*)\)([\s\S]*)/g.exec(o))||e.length<4?{}:{prefix:e[1],value:e[2],suffix:e[3]}).value.split(/s*,\s*/g).map(function(t){return parseFloat(t)});r.push(i)}else r.push("none");n=n.parentElement}r.reverse();var a=[1,0,0,1,0,0],s=r.length,l=[1,0,0,1,0,0];return r.forEach(function(t,e){s-1===e&&(l=a.slice()),"none"!==t&&Ot(a,t)}),l[4]=0,l[5]=0,a[4]=0,a[5]=0,[l,a]}(t))[0],a=(r=Rt(f=n[1],v=m.transformOrigin.split(" ").map(function(t){return parseFloat(t)}),d,h))[0],s=r[1],l=r[2],p=r[3],c=r[4]}return{transform:"",target:t,left:o,top:i,pos1:s,pos2:l,pos3:p,pos4:c,width:d,height:h,beforeMatrix:u,matrix:f,origin:a,transformOrigin:v}}function Wt(t){var e=t.getAttribute("data-position");if(e){var n=[0,0];return-1<e.indexOf("w")&&(n[0]=-1),-1<e.indexOf("e")&&(n[0]=1),-1<e.indexOf("n")&&(n[1]=-1),-1<e.indexOf("s")&&(n[1]=1),n}}function Tt(t,e,n,r){var o=e.startRad,i=e.prevRad,a=e.loop,s=t.getRadByPos([n,r]);s<i&&270<i&&s<90?++e.loop:i<s&&i<90&&270<s&&--e.loop;var l=360*a+i,p=360*e.loop+s,c=t.state,u=c.width,f=c.height,d=c.transformOrigin,h=c.origin,v=c.left,g=c.top,m=e.direction,y=function(t,e){var n=t.slice(),r=Math.cos(e),o=Math.sin(e);return Ot(n,[r,o,-o,r,0,0])}(e.matrix,m*(s-o)),b=[v+h[0],g+h[1]],_=Rt(y,d,u,f),x=_[0],w=_[1],S=_[2],N=_[3],P=_[4],C=b[0]-x[0],D=b[1]-x[1];return e.prevRad=s,{delta:m*(p-l)/Math.PI*180,dist:m*(l-o)/Math.PI*180,origin:x,pos1:w,pos2:S,pos3:N,pos4:P,matrix:y,left:C,top:D}}function Bt(s,t){var l;return wt(t,{container:window,dragstart:function(t){var e=t.datas,n=t.inputEvent,r=t.clientX,o=t.clientY,i=n.target;if(l="",!yt(i,Ct("control")))return!1;if(yt(i,Ct("rotation")))return l="rotate",function(t,e){var n=e.datas,r=e.clientX,o=e.clientY,i=t.props.target;if(!i)return!1;var a=t.state,s=a.matrix,l=a.left,p=a.top;n.transform=window.getComputedStyle(i).transform,n.matrix=s,n.left=l,n.top=p,n.prevRad=t.getRadByPos([r,o]),n.startRad=n.prevRad,n.loop=0,n.direction=t.getDirection(),"none"===n.transform&&(n.transform=""),t.props.onRotateStart({target:i})}(s,{datas:e,clientX:r,clientY:o});if(s.props.scalable){var a=Wt(i);return l="scale",function(t,e,n){var r=n.datas,o=t.props.target;if(!e||!o)return!1;var i=window.getComputedStyle(o),a=t.state,s=a.matrix,l=a.width,p=a.height,c=a.left,u=a.top,f=a.transformOrigin,d=a.origin;r.matrix=Et(s.slice()),r.transform=i.transform,r.prevDist=[1,1],r.position=e,r.width=l,r.height=p,r.transformOrigin=f,r.originalMatrix=s,r.originalOrigin=d,r.left=c,r.top=u,"none"===r.transform&&(r.transform=""),t.props.onScaleStart({target:o})}(s,a,{datas:e})}if(s.props.resizable){a=Wt(i);return l="resize",function(t,e,n){var r=n.datas,o=(n.inputEvent,t.props.target);if(!o||!e)return!1;var i=t.state.beforeMatrix,a=jt(o),s=a[0],l=a[1];r.matrix=Et(i.slice()),r.position=e,r.width=s,r.height=l,r.prevWidth=0,r.prevHeight=0,t.props.onResizeStart({target:o})}(s,a,{datas:e})}return!1},drag:function(t){var e=t.datas,n=t.clientX,r=t.clientY,o=t.distX,i=t.distY;if(l)return"rotate"===l?function(t,e){var n=e.datas,r=Tt(t,n,e.clientX,e.clientY),o=r.delta,i=r.dist,a=r.origin,s=r.pos1,l=r.pos2,p=r.pos3,c=r.pos4,u=r.matrix,f=r.left,d=r.top;t.props.onRotate({target:t.props.target,delta:o,dist:i,transform:n.transform+" rotate("+i+"deg)"}),t.setState({origin:a,pos1:s,pos2:l,pos3:p,pos4:c,matrix:u,left:f,top:d})}(s,{datas:e,clientX:n,clientY:r}):"scale"===l?function(t,e){var n=e.datas,r=e.distX,o=e.distY,i=n.originalMatrix,a=n.matrix,s=n.prevDist,l=n.position,p=n.width,c=n.height,u=n.left,f=n.top,d=n.transformOrigin,h=n.originalOrigin,v=n.transform,g=Dt(a,[r,o,1]),m=l[0]*g[0],y=l[1]*g[1];if(l[0]&&l[1]){var b=Math.sqrt(m*m+y*y),_=Mt([0,0],g),x=Mt([0,0],l),w=Math.cos(_-x)*b;y=(m=w)*c/p}var S=(p+m)/p,N=(c+y)/c,P=Rt(Ot(i.slice(),[S,0,0,N,0,0]),d,p,c),C=P[0],D=P[1],O=P[2],E=P[3],R=P[4],M=u+h[0]-C[0],k=f+h[1]-C[1];n.prevDist=[S,N],t.props.onScale({target:t.props.target,scale:[S,N],dist:[S-1,N-1],delta:[S-s[0],N-s[1]],transform:v+" scale("+S+", "+N+")"}),t.setState({origin:C,pos1:D,pos2:O,pos3:E,pos4:R,left:M,top:k})}(s,{datas:e,distX:o,distY:i}):"resize"===l?function(t,e){var n=e.datas,r=e.distX,o=e.distY,i=n.matrix,a=n.position,s=n.width,l=n.height,p=n.prevWidth,c=n.prevHeight,u=Dt(i,[r,o,1]),f=a[0]*u[0],d=a[1]*u[1];if(a[0]&&a[1]){var h=Math.sqrt(f*f+d*d),v=Mt([0,0],u),g=Mt([0,0],a),m=Math.cos(v-g)*h;d=(f=m)*l/s}var y=s+f,b=l+d;n.prevWidth=f,n.prevHeight=d,t.props.onResize({target:t.props.target,width:y,height:b,dist:[f,d],delta:[f-p,d-c]}),t.updateRect()}(s,{datas:e,distX:o,distY:i}):void 0},dragend:function(t){var e=t.isDrag;if(l)return"rotate"===l?function(t,e){var n=e.isDrag;t.props.onRotateEnd({target:t.props.target,isDrag:n}),n&&t.updateRect()}(s,{isDrag:e}):"scale"===l?function(t,e){var n=e.isDrag;t.props.onScaleEnd({target:t.props.target,isDrag:n}),n&&t.updateRect()}(s,{isDrag:e}):"resize"===l?function(t,e){var n=e.isDrag;t.props.onScaleEnd({target:t.props.target,isDrag:n}),n&&t.updateRect()}(s,{isDrag:e}):void 0}})}var Ut,At,Ht,Xt,Yt,Ft=(Ut="div",Xt="rCS"+function(t){return xt(t).toString(36)}(At=Pt),Yt=0,function(e){function t(t){return e.call(this,t)||this}return function(t,e){function n(){this.constructor=t}bt(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(t,e),t.prototype.render=function(){var t=this.props,e=t.className,n=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]])}return n}(t,["className"]);return nt(Ut,_t({className:e+" "+Xt},n))},t.prototype.componentDidMount=function(){0===Yt&&(Ht=function(n,t){var e=document.createElement("style");return e.setAttribute("type","text/css"),e.innerHTML=t.replace(/([^}{]*){/gm,function(t,e){return function(t){var e=t.match(/("[^"]*"|'[^']*'|[^,\s()]*\((?:[^()]*|\([^()]*\))*\)[^,\s()]*|[^,])+/g);return e?e.map(function(t){return t.trim()}):[]}(e).map(function(t){return-1<t.indexOf(":host")?""+t.replace(/\:host/g,"."+n):"."+n+" "+t}).join(", ")+"{"}),(document.head||document.body).appendChild(e),e}(Xt,At)),++Yt},t.prototype.componentWillUnmount=function(){0==--Yt&&Ht&&Ht.parentNode.removeChild(Ht)},t.prototype.getElement=function(){return this.element||(this.element=function(t){return t&&(t.base||1===t.nodeType&&t)||null}(this))},t}(ht)),It=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={target:null,beforeMatrix:[1,0,0,1,0,0],matrix:[1,0,0,1,0,0],left:0,top:0,width:0,height:0,transform:"",transformOrigin:[0,0],origin:[0,0],pos1:[0,0],pos2:[0,0],pos3:[0,0],pos4:[0,0]},t}!function(t,e){function n(){this.constructor=t}St(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(t,e);var n=t.prototype;return n.isMoveableElement=function(t){return t&&-1<t.className.indexOf(Nt)},n.render=function(){this.state.target!==this.props.target&&this.updateRect(!0);var t=this.state,e=t.origin,n=t.left,r=t.top,o=t.pos1,i=t.pos2,a=t.pos3,s=t.pos4,l=t.target,p=t.transform,c=this.getDirection(),u=Mt(o,i)-c*Math.PI/2;return nt(Ft,{ref:f(this,"controlBox"),className:Ct("control-box",-1===c?"reverse":""),style:{position:"fixed",display:l?"block":"none",transform:"translate("+n+"px, "+r+"px) "+p}},nt("div",{className:Ct("line"),style:{transform:kt(o,i)}}),nt("div",{className:Ct("line"),style:{transform:kt(i,s)}}),nt("div",{className:Ct("line"),style:{transform:kt(o,a)}}),nt("div",{className:Ct("line"),style:{transform:kt(a,s)}}),nt("div",{className:Ct("line rotation"),style:{transform:"translate("+(o[0]+i[0])/2+"px, "+(o[1]+i[1])/2+"px) rotate("+u+"rad)"}},nt("div",{className:Ct("control","rotation"),ref:f(this,"rotationElement")})),nt("div",{className:Ct("control","origin"),style:zt(e)}),nt("div",{className:Ct("control","nw"),"data-position":"nw",style:zt(o)}),nt("div",{className:Ct("control","n"),"data-position":"n",style:zt(o,i)}),nt("div",{className:Ct("control","ne"),"data-position":"ne",style:zt(i)}),nt("div",{className:Ct("control","w"),"data-position":"w",style:zt(o,a)}),nt("div",{className:Ct("control","e"),"data-position":"e",style:zt(i,s)}),nt("div",{className:Ct("control","sw"),"data-position":"sw",style:zt(a)}),nt("div",{className:Ct("control","s"),"data-position":"s",style:zt(a,s)}),nt("div",{className:Ct("control","se"),"data-position":"se",style:zt(s)}))},n.componentDidMount=function(){this.moveableDragger=Bt(this,this.controlBox.getElement())},n.componentWillUnmount=function(){this.draggableDragger&&(this.draggableDragger.unset(),this.draggableDragger=null),this.moveableDragger&&(this.moveableDragger.unset(),this.moveableDragger=null)},n.getRadByPos=function(t){var e=this.state,n=e.left,r=e.top,o=e.origin;return Mt([n+o[0],r+o[1]],t)},n.getDirection=function(){var t=this.state,e=t.pos1,n=t.pos2,r=t.origin,o=Math.PI,i=Mt(r,e),a=Mt(r,n);return i<a&&a-i<o||a<i&&a-i<-o?1:-1},n.updateRect=function(t){var e=this.props.target;this.state.target!==e&&(this.draggableDragger&&(this.draggableDragger.unset(),this.draggableDragger=null),e&&this.props.draggable&&(this.draggableDragger=function(m,y){return wt(y,{container:window,dragstart:function(t){var e=t.datas,n=window.getComputedStyle(y),r=m.state,o=r.matrix,i=r.beforeMatrix;return e.matrix=Et(o.slice()),e.beforeMatrix=Et(i.slice()),e.left=parseFloat(n.left||"")||0,e.top=parseFloat(n.top||"")||0,e.bottom=parseFloat(n.bottom||"")||0,e.right=parseFloat(n.right||"")||0,e.transform=n.transform,e.prevDist=[0,0],e.prevBeforeDist=[0,0],"none"===e.transform&&(e.transform=""),m.props.onDragStart({target:y})},drag:function(t){var e=t.datas,n=t.distX,r=t.distY,o=e.beforeMatrix,i=e.matrix,a=e.prevDist,s=e.prevBeforeDist,l=Dt(o,[n,r,1]),p=Dt(i,[n,r,1]),c=[p[0]-a[0],p[1]-a[1]],u=[l[0]-s[0],l[1]-s[1]];e.prevDist=p,e.prevBeforeDist=l;var f=e.left+l[0],d=e.top+l[1],h=e.right-l[0],v=e.bottom-l[1],g=e.transform+" translate("+p[0]+"px, "+p[1]+"px)";m.props.onDrag({target:y,transform:g,dist:p,delta:c,beforeDist:l,beforeDelta:u,left:f,top:d,right:h,bottom:v}),m.setState({transform:"translate("+n+"px, "+r+"px)"})},dragend:function(t){var e=t.isDrag;m.props.onDragEnd({target:y,isDrag:e}),e&&m.updateRect()}})}(this,e))),this.updateState(Lt(e),t)},n.updateState=function(t,e){var n=this.state;if(e)for(var r in t)n[r]=t[r];else this.setState(t)},t.defaultProps={rotatable:!0,draggable:!0,scalable:!0,resizable:!1,onRotateStart:function(){},onRotate:function(){},onRotateEnd:function(){},onDragStart:function(){},onDrag:function(){},onDragEnd:function(){},onScaleStart:function(){},onScale:function(){},onScaleEnd:function(){},onResizeStart:function(){},onResize:function(){},onResizeEnd:function(){}},t}(vt),Vt=function(n){function t(t){var e=n.call(this,t)||this;return e.state={},e.state=e.props,e}return i(t,n),t.prototype.render=function(){return d(It,a({},this.state))},t}(N);return function(o){function t(t,e){void 0===e&&(e={});var n=o.call(this)||this;n.onDragStart=function(t){n.trigger("dragStart",t)},n.onDrag=function(t){n.trigger("drag",t)},n.onDragEnd=function(t){n.trigger("dragEnd",t)},n.onResizeStart=function(t){n.trigger("resizeStart",t)},n.onResize=function(t){n.trigger("resize",t)},n.onResizeEnd=function(t){n.trigger("resizeEnd",t)},n.onScaleStart=function(t){n.trigger("scaleStart",t)},n.onScale=function(t){n.trigger("scale",t)},n.onScaleEnd=function(t){n.trigger("scaleEnd",t)},n.onRotateStart=function(t){n.trigger("rotateStart",t)},n.onRotate=function(t){n.trigger("rotate",t)},n.onRotateEnd=function(t){n.trigger("rotateEnd",t)};var r=document.createElement("div");return function(t,e,n){k(n,t,{},!1,e,!1)}(d(Vt,a({ref:f(n,"preactMoveable")},e,{onDragStart:n.onDragStart,onDrag:n.onDrag,onDragEnd:n.onDragEnd,onResizeStart:n.onResizeStart,onResize:n.onResize,onResizeEnd:n.onResizeEnd,onScaleStart:n.onScaleStart,onScale:n.onScale,onScaleEnd:n.onScaleEnd,onRotateStart:n.onRotateStart,onRotate:n.onRotate,onRotateEnd:n.onRotateEnd})),r),t.appendChild(r.children[0]),n}i(t,o);var e=t.prototype;return Object.defineProperty(e,"draggable",{get:function(){return this.preactMoveable.state.draggable||!1},set:function(t){this.preactMoveable.setState({draggable:t})},enumerable:!0,configurable:!0}),Object.defineProperty(e,"target",{get:function(){return this.preactMoveable.state.draggable||!1},set:function(t){this.preactMoveable.setState({target:t})},enumerable:!0,configurable:!0}),Object.defineProperty(e,"resizable",{get:function(){return this.preactMoveable.state.resizable||!1},set:function(t){this.preactMoveable.setState({resizable:t})},enumerable:!0,configurable:!0}),Object.defineProperty(e,"scalable",{get:function(){return this.preactMoveable.state.scalable||!1},set:function(t){this.preactMoveable.setState({scalable:t})},enumerable:!0,configurable:!0}),Object.defineProperty(e,"rotatable",{get:function(){return this.preactMoveable.state.rotatable||!1},set:function(t){this.preactMoveable.setState({rotatable:t})},enumerable:!0,configurable:!0}),t}(t)});
//# sourceMappingURL=moveable.min.js.map
